@page "/pizza-details/{Id:int}"
@inject IPizzaService PizzaService
@inject NavigationManager NavigationManager
@rendermode @(new InteractiveServerRenderMode(prerender: false))

<div class="main">
    <div class="pizza-details-title">
        <h3>Blazzing Pizza Presents</h3>
        <h1>@CurrentPizza.Name</h1>
    </div>
    <div class="pizza-details-divider">
        @for(int i=0; i<4; i++) {
            <img class="pizza-details-img" src="@CurrentPizza.ImageUrl"/>
        }
    </div>
    <div class="pizza-details-description">
        <h3>@CurrentPizza.Description</h3>
    </div>
    <div class="pizza-details-btns">
        <button class="btn btn-info" @onclick=@(() => GoHome())>Go Home</button>
        <button class="btn btn-success" @onclick=@(() => Buy(@CurrentPizza.Id))>Buy</button>
    </div>
</div>

@code {
    [Parameter]
    public int? Id { get; set; }

    public Pizza CurrentPizza { get; set; } = new();

    protected override async Task OnParametersSetAsync()
    {
        if(Id is not null)
        {
            var pizza = await PizzaService.GetPizzaByIdAsync((int)Id);
            if(pizza is not null)
                CurrentPizza = pizza;
        }
    }

    public void GoHome()
    {
        NavigationManager.NavigateTo("/");
    }

    public void Buy(int id)
    {
        NavigationManager.NavigateTo($"/buy-pizza/{id}");
    }
}